<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="MTunnel.Pages.TunnelLog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:MTunnel.Pages"
    xmlns:localComponent="using:MTunnel.Components"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="TunnelLog"
    Closed="Window_Closed">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TitleBar
            x:Name="SimpleTitleBar"
            Title="MTunnel Log">
            <TitleBar.IconSource>
                <FontIconSource Glyph="&#xE9A4;"/>
            </TitleBar.IconSource>
        </TitleBar>

        <Grid
            Grid.Row="1"
            Padding="12"
            RowSpacing="8"
            Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
            <Grid.RowDefinitions>
                <RowDefinition Height="32"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <StackPanel
                Grid.Row="0"
                Orientation="Horizontal"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Spacing="8">
                <localComponent:ButtonIconText
                    HorizontalAlignment="Left"
                    IconGlyph="&#xE74D;"
                    Click="ClearButton_Click">
                    Clear
                </localComponent:ButtonIconText>

                <CheckBox
                    x:Name="StdOutCheckBox"
                    Content="Stdout"
                    IsChecked="True"
                    Checked="StdOutCheckBox_Checked"
                    Unchecked="StdOutCheckBox_Checked"/>
                <CheckBox
                    x:Name="StdInCheckBox"
                    Content="Stdin"
                    IsChecked="True"
                    Checked="StdInCheckBox_Checked"
                    Unchecked="StdInCheckBox_Checked"/>
                <CheckBox
                    x:Name="StdErrCheckBox"
                    Content="Stderr"
                    IsChecked="True"
                    Checked="StdErrCheckBox_Checked"
                    Unchecked="StdErrCheckBox_Checked"/>
            </StackPanel>

            <ListView
                x:Name="LogListView"
                Grid.Row="1"
                ItemsSource="{x:Bind LogEntries}"
                HorizontalAlignment="Stretch"
                Width="Auto">
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="local:LogEntry">
                        <Grid ColumnSpacing="10" Padding="8" RowSpacing="4">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,10,0">
                                <TextBlock Text="{x:Bind Type}" FontWeight="Bold" Margin="0,0,5,0" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Text="|" FontWeight="Bold" Margin="0,0,5,0" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Grid.Column="0" Text="{x:Bind Timestamp}" Margin="0,0,10,0" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            </StackPanel>
                            <TextBlock
                                Grid.Row="1"
                                Text="{x:Bind Message}"
                                TextWrapping="Wrap"
                                FontFamily="Consolas"
                                IsTextSelectionEnabled="True"/>
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </Grid>
    </Grid>
</Window>
